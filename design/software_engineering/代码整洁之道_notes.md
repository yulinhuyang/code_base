
## 第1章 命名

### 1.避免误导

"一组账号"别用accountList表示，List对程序员有特殊含义，可以用accountGroup、bunchOfAccounts、甚至是accounts

不使用区别较小的名称，ZYXControllerForEfficientHandlingOfStrings和ZYXControllerForEfficientStorageOfStrings难以辨别

不使用小写l、大写O作变量名，看起来像常量1、0

### 2.做有意义的区分

不以数字系列命名(a1、a2、a3)，按照真实含义命名

Product/ProductInfo/ProductData 意思无区别，只统一用一个

别写冗余的名字，变量名别带variable、表名别带table

### 3.使用可搜索的名称

单字母名称和数字常量很难在上下文中找出。名称长短应与其作用域大小相对应，越是频繁出现的变量名称得越容易搜索(越长)

### 4.命名时避免使用编码

把类型和作用域编码进名称里增加了解码负担。意味着新人除了了解代码逻辑之外，还需要学习这种编码语言。

别使用匈牙利语标记法(格式：[Prefix]-BaseTag-Name 其中BaseTag是数据类型的缩写，Name是变量名字)，纯属多余

不必用"m_"前缀来表明成员变量

接口和实现别在名称中编码。接口名IShapeFactory的前导"I"是废话。如果接口和实现必须选一个编码，宁可选实现，ShapeFactoryImp都比对接口名称编码来的好

### 5.类名、方法名

类名应当是名词或名词短语，方法名应当是动词或动词短语

### 6.每个概念用一个词

fetch、retrieve、get约定一个一直用即可

### 7.别用双关语

add方法一般语义是：根据两个值获得一个新的值。如果要把单个值加入到某个集合，用insert或append命名更好，这里用add就是双关语了。

### 8.添加有意义的语境

很少有名称能自我说明，需要用良好命名的类、函数、或者命名空间来放置名称，给读者提供语境，如果做不到的话，给名称添加前缀就是最后一招了。

## 第2章 函数

### 1.越短小越好

if/else/while语句的代码块应该只有一行，该行应该是一个函数调用语句。

函数的缩进层级不应该多于一层或两层。

### 2.只做一件事

如果函数只是做了该函数名下同一抽象层上的步骤，则函数只做了一件事。

要判断函数是否不止做了一件事，就是要看是否能再拆出一个函数。

### 3.每个函数一个抽象层级

### 4.switch语句

把switch埋在较低的抽象层级，一般可以放在抽象工厂底下，用于创建多态对象。

### 5.使用描述性的名称

函数越短小、功能越集中，就越便于取个好名字。

别害怕长名称，长而具有描述性的名称，要比短而令人费解的名称好，要比描述性的长注释好。

别害怕花时间取名字。

### 6.函数参数

参数越少越好，0参数最好，尽量避免用三个以上参数

参数越多，编写组合参数的测试用例就越困难

别用标识参数，向函数传入bool值是不好的，这意味着函数不止做一件事。可以将此函数拆成两个。

如果函数需要两个、三个或者三个以上参数，就说明其中一些参数应该封装成类了。

将参数的顺序编码进函数名，减轻记忆参数顺序的负担，例如,assertExpectedEqualsActual(expected, actual)

### 7.副作用(函数在正常工作任务之外对外部环境所施加的影响)

检查密码并且初始化session的方法 命名为checkPasswordAndInitializeSession而非checkPassword，即使违反单一职责原则也不要有副作用

避免使用"输出参数"，如果函数必须修改某种状态，就修改所属对象的状态吧

### 8.设置(写)和查询(读)分离

if(set("username", "unclebob")) { ... } 的含义模糊不清。应该改为:

	if (attributeExists("username")) { 
		setAttribute("username", "unclebob");
		...
	}

### 9.使用异常代替返回错误码

返回错误码会要求调用者立刻处理错误，从而引起深层次的嵌套结构:

	if (deletePate(page) == E_OK) {
		if (xxx() == E_OK) {
			if (yyy() == E_OK) {
				log();
			} else {
				log();
			}
		} else {
			log();
		}
	} else {
		log();
	}

使用异常机制:

	try {
		deletePage();
		xxx();
		yyy();
	} catch (Exception e) {
		log(e->getMessage());
	}

try/catch代码块丑陋不堪，所以最好把try和catch代码块的主体抽离出来，单独形成函数

	try {
		do();
	} catch (Exception e) {
		handle();
	}

函数只做一件事，错误处理就是一件事。如果关键字try在某个函数中存在，它就该是函数的第一个单词，而且catch代码块后面也不该有其他内容。

定义错误码的class需要添加新的错误码时，所有用到错误码class的其他class都得重新编译和部署。但如果使用异常而非错误码，新异常可以从异常class派生出来，无需重新编译或部署。这也是开放闭合原则(对扩展开放，对修改封闭)的范例。


### 10.不要写重复代码

重复是软件中一切邪恶的根源。当算法改变时需要修改多处地方

### 11.结构化编程

只要函数保持短小，偶尔出现的return、break、continue语句没有坏处，甚至还比单入单出原则更具有表达力。goto只有在大函数里才有道理，应该尽量避免使用。

### 12.如何写出这样的函数

并不需要一开始就按照这些规则写函数，没人做得到。想些什么就写什么，然后再打磨这些代码，按照这些规则组装函数。


## 第3章 注释

若编程语言足够有表现力，我们就不需要注释。 

注释总是一种失败。

代码在演化，注释却不总是随之变动。

不准确的注释比没注释坏的多。


### 1.用代码来阐述

创建一个与注释所言同一事物的函数即可

	// check to see if the employee is eligible for full benefits
	if ((employee.falgs & HOURLY_FLAG) && (employee.age > 65))

应替换为

	if (employee.isEligibleForFullBenefits())

### 2.好注释

法律信息

提供基本信息，如解释某个抽象方法的返回值

对意图的解释，反应了作者某个决定后面的意图

阐释。把某些晦涩的参数或者返回值的意义翻译成可读的形式(更好的方法是让它们自身变得足够清晰，但是类似标准库的代码我们无法修改):

	if (b.compareTo(a) == 1) //b > a

警示。// don't run unless you have some time to kill

TODO注释

放大 一些看似不合理之物 的重要性	


### 3.坏注释

自言自语

多余的注释。把逻辑在注释里写一遍不能比代码提供更多信息，读它不比读代码简单。一目了然的成员变量别加注释，显得很多余。

误导性注释

遵循规矩的注释。每个函数都加注释、每个变量都加注释是愚蠢的。

日志式注释。有了代码版本控制工具，不必在文件开头维护修改时间、修改人这类日志式的注释

能用函数或者变量表示就别用注释:

	// does the module from the global list <mod> 
	// depend on the subsystem we are part of?
	if (smodule.getDependSubsystems().contains(subSysMod.getSubSystem())

可以改为

	ArrayList moduleDependees = smodule.getDependSubsystems();
	String ourSubSystem = subSysMod.getSubSystem();
	if (moduleDependees.contains(ourSubSystem))
	
位置标记。标记多了会被我们忽略掉:

///////////////////// Actions //////////////////////////

右括号注释

	try {
		while () {
			if () {
				...
			} // if
			...
		} // while
		...
	} // try
	
如果你想标记右括号，其实应该做的是缩短函数

署名 /* add by rick */ 源代码控制工具会记住你，署名注释跟不上代码的演变。

注释掉的代码。会导致看到这段代码其他人不敢删除

信息过多。别在注释中添加有趣的历史话题或者无关的细节

没解释清楚的注释。注释的作用是解释未能自行解释的代码，如果注释本身还需要解释就太遗憾了。

短函数的函数头注释。为短函数选个好名字比函数头注释要好。

非公共API函数的javadoc/phpdoc注释。


### 第4章  代码格式

1.垂直格式

短文件比长文件更易于理解。平均200行，最多不超过500行的单个文件可以构造出色的系统

区隔: 封包声明、导入声明、每个函数之间，都用空白行分隔开，空白行下面标识着新的独立概念

靠近: 紧密相关的代码应该互相靠近，例如一个类里的属性之间别用空白行隔开

变量声明应尽可能靠近其使用位置：循环中的控制变量应该总是在循环语句中声明。

成员变量应该放在类的顶部声明，不要四处放置

如果某个函数调用了另外一个，就应该把它们放在一起。我们希望底层细节最后展现出来，不用沉溺于细节，所以调用者尽可能放在被调用者之上。

执行同一基础任务的几个函数应该放在一起。

2.水平格式

一行代码不必死守80字符的上限，偶尔到达100字符不超过120字符即可。

区隔与靠近: 空格强调左右两边的分割。赋值运算符两边加空格，函数名与左圆括号之间不加空格，乘法运算符在与加减法运算符组合时不用加空格(a*b - c)

不必水平对齐。例如声明一堆成员变量时，各行不用每一个单词都对齐。

短小的if、while、函数里最好也不要违反缩进规则，不要这样:

	if (xx == yy) z = 1;


 





